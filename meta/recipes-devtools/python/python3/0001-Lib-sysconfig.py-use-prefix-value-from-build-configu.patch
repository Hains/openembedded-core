From 3f4f3e917950e286d5729ea949ca342995eb3c3e Mon Sep 17 00:00:00 2001
From: Alexander Kanavin <alex@linutronix.de>
Date: Fri, 17 Nov 2023 14:26:32 +0100
Subject: [PATCH] Lib/sysconfig.py: use prefix value from build configuration
 file

This allows correctly substituting them for target installs using
native python.

Upstream-Status: Inappropriate [oe-core cross builds]
Signed-off-by: Alexander Kanavin <alex@linutronix.de>
---
 Lib/sysconfig/__init__.py | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/Lib/sysconfig/__init__.py b/Lib/sysconfig/__init__.py
index 2ecbff2..5aa964c 100644
--- a/Lib/sysconfig/__init__.py
+++ b/Lib/sysconfig/__init__.py
@@ -523,12 +523,11 @@ def _init_config_vars():
     if os.name == 'posix':
         _init_posix(_CONFIG_VARS)
         # If we are cross-compiling, load the prefixes from the Makefile instead.
-        if '_PYTHON_PROJECT_BASE' in os.environ:
-            prefix = _CONFIG_VARS['host_prefix']
-            exec_prefix = _CONFIG_VARS['host_exec_prefix']
-            base_prefix = _CONFIG_VARS['host_prefix']
-            base_exec_prefix = _CONFIG_VARS['host_exec_prefix']
-            abiflags = _CONFIG_VARS['ABIFLAGS']
+        prefix = _CONFIG_VARS['host_prefix']
+        exec_prefix = _CONFIG_VARS['host_exec_prefix']
+        base_prefix = _CONFIG_VARS['host_prefix']
+        base_exec_prefix = _CONFIG_VARS['host_exec_prefix']
+        abiflags = _CONFIG_VARS['ABIFLAGS']
 
     # Normalized versions of prefix and exec_prefix are handy to have;
     # in fact, these are the standard versions used most places in the
